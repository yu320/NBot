services:
  nbot:
    # 您的映像檔名稱 (請確保這與您在 GHCR 上的名稱一致)
    image: ghcr.io/yu320/nbot-discord:latest
    
    # 您的容器名稱
    container_name: nbot
    
    # 保持容器自動重啟
    restart: unless-stopped
    
    # 
    # -----------------------------------------------------
    # ✅ 完整的環境變數清單
    # -----------------------------------------------------
    # 這些是您需要在 Dockge 介面上設定的變數 (Secrets)。
    # (左邊是 Python 讀取的名稱，右邊是您在 Dockge 設定的名稱)
    #
    environment:
      # --- 核心功能 ---
      - TZ=Asia/Taipei
      - DISCORD_TOKEN=${TOKEN}
      - CHANNEL_ID=${CHAN_ID}
      
      # --- 擴展功能 ---
      - UPTIME_KUMA_URL=${KUMA_URL}
      - CALENDAR_API_URL=${CAL_API_URL}
      - MUSIC_CHANNEL_ID=${MUSIC_CHAN_ID}
      
      # --- ✅ 課程監測功能 (新功能) ---
      
      # 1. (必要) 監測通知要發送到的頻道 ID
      - MONITOR_CHANNEL_ID=${MONITOR_CHANNEL_ID}
      - MONITOR_ROLE_CATEGORY_ID=${MONITOR_CATEGORY_ID}
      
      # --- ✅ 新增：IP 流量監測功能 ---
      # (請在 Dockge 中建立一個名為 IP_MONITOR_CHAN_ID 的變數)
      - IP_MONITOR_CHANNEL_ID=${IP_MONITOR_CHAN_ID}
      
    volumes:
      # ✅ 修正後的 Volume 路徑 (只映射 data 資料夾)
      # 確保您的課程監測清單 (monitor_list.json) 和音樂清單 (music_list.json)
      # 會被儲存在您主機上的 ./data 資料夾中，而不是在容器內遺失。
      - ./data:/app/data

networks: {}
